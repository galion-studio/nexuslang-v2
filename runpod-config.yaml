# Nexus Lang V2 Scientific Knowledge Enhancement - RunPod Configuration
# ====================================================================
#
# This configuration deploys the complete scientific AI system on RunPod
# with GPU acceleration for enhanced scientific computing capabilities.
#
# Deployment includes:
# - Scientific Knowledge Enhancement API
# - Multi-agent scientific collaboration
# - External knowledge integration
# - Complete transparency system
# - Web dashboard interface

# RunPod Configuration
version: "1.0"
name: "nexus-lang-v2-scientific-ai"
display_name: "Nexus Lang V2 Scientific AI"
description: "EXTREMELY DEEP understanding of how laws work and how history works through first principles thinking and multi-agent scientific collaboration"

# GPU Configuration
accelerators:
  - type: "NVIDIA RTX A4000"  # High-end GPU for scientific computing
    count: 1

# Container Configuration
image:
  dockerfile: "runpod.Dockerfile"
  context: "."

# Runtime Configuration
runtime:
  ports:
    - name: "api"
      port: 8000
      type: "http"
    - name: "dashboard"
      port: 8080
      type: "http"

  # Environment Variables
  env:
    - name: "PYTHONPATH"
      value: "/workspace"
    - name: "LOG_LEVEL"
      value: "INFO"
    - name: "MAX_CONCURRENT_AGENTS"
      value: "5"
    - name: "TRANSPARENCY_RETENTION_DAYS"
      value: "30"
    - name: "CACHE_TTL"
      value: "3600"
    - name: "REQUEST_TIMEOUT"
      value: "30"
    - name: "RATE_LIMIT_REQUESTS_PER_MINUTE"
      value: "100"

  # Resource Limits
  resources:
    cpu:
      request: "2"
      limit: "4"
    memory:
      request: "4Gi"
      limit: "16Gi"
    gpu:
      request: "1"
      limit: "1"

  # Storage
  volumes:
    - name: "workspace"
      mountPath: "/workspace"
      size: "50Gi"
      type: "persistent"

# Health Checks
health_check:
  http_get:
    path: "/health"
    port: 8000
    initial_delay_seconds: 30
    period_seconds: 10
    timeout_seconds: 5
    failure_threshold: 3

# Startup Command
command:
  - "python"
  - "-m"
  - "uvicorn"
  - "v2.backend.main:app"
  - "--host"
  - "0.0.0.0"
  - "--port"
  - "8000"
  - "--workers"
  - "2"

# Network Configuration
network:
  ingress:
    - name: "api"
      port: 8000
      protocol: "http"
      cors:
        allowed_origins: ["*"]
        allowed_methods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
        allowed_headers: ["*"]
        allow_credentials: true

    - name: "dashboard"
      port: 8080
      protocol: "http"
      cors:
        allowed_origins: ["*"]
        allowed_methods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
        allowed_headers: ["*"]
        allow_credentials: true

# Scaling Configuration
scaling:
  min_replicas: 1
  max_replicas: 3
  target_cpu_utilization_percentage: 70
  target_memory_utilization_percentage: 80

# Monitoring Configuration
monitoring:
  enabled: true
  metrics:
    - name: "scientific_queries_total"
      type: "counter"
      description: "Total number of scientific queries processed"
    - name: "query_processing_duration"
      type: "histogram"
      description: "Time taken to process scientific queries"
    - name: "agent_collaborations_total"
      type: "counter"
      description: "Total number of multi-agent collaborations"
    - name: "transparency_score"
      type: "gauge"
      description: "Average transparency score"
    - name: "scientific_accuracy"
      type: "gauge"
      description: "Scientific accuracy percentage"

# Backup Configuration
backup:
  enabled: true
  schedule: "0 2 * * *"  # Daily at 2 AM UTC
  retention_days: 30
  paths:
    - "/workspace/data"
    - "/workspace/logs"

# Security Configuration
security:
  # API Key Authentication (configure in environment)
  authentication:
    enabled: true
    type: "api_key"
    header_name: "X-API-Key"

  # Network Security
  network_policy:
    ingress:
      - from:
          - pod_selector:
              match_labels:
                app: "nexus-scientific"
        ports:
          - protocol: "TCP"
            port: 8000
          - protocol: "TCP"
            port: 8080

  # Resource Limits
  resource_quotas:
    requests:
      cpu: "2"
      memory: "4Gi"
    limits:
      cpu: "4"
      memory: "16Gi"

# Logging Configuration
logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  handlers:
    - type: "console"
    - type: "file"
      path: "/workspace/logs/scientific.log"
      max_size: "100MB"
      backup_count: 5

# Custom Metadata
metadata:
  author: "Nexus Lang V2 Team"
  version: "2.0.0"
  license: "MIT"
  repository: "https://github.com/nexus-lang-v2/scientific-ai"
  documentation: "https://docs.nexus-lang-v2.com"
  tags:
    - "scientific-ai"
    - "first-principles"
    - "multi-agent"
    - "transparency"
    - "knowledge-integration"
    - "physics"
    - "chemistry"
    - "mathematics"

# Cost Optimization
cost_optimization:
  spot_instances: true
  auto_shutdown:
    enabled: true
    idle_timeout_minutes: 30
  resource_optimization:
    enabled: true
    scale_down_threshold: 0.3
