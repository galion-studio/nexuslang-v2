# Fail2ban configuration for Nginx
# Location: /etc/fail2ban/jail.d/nginx.conf
# Install with: sudo cp configs/fail2ban-nginx.conf /etc/fail2ban/jail.d/nginx.conf
# Restart: sudo systemctl restart fail2ban

[nginx-http-auth]
enabled = true
port = http,https
logpath = /var/log/nginx/error.log
maxretry = 3
findtime = 600  # 10 minutes
bantime = 3600  # 1 hour
action = iptables-multiport[name=NoAuthFailures, port="http,https"]

[nginx-noscript]
enabled = true
port = http,https
logpath = /var/log/nginx/access.log
maxretry = 6
findtime = 600
bantime = 86400  # 24 hours
filter = nginx-noscript
action = iptables-multiport[name=NoScript, port="http,https"]

[nginx-badbots]
enabled = true
port = http,https
logpath = /var/log/nginx/access.log
maxretry = 2
findtime = 86400
bantime = 604800  # 7 days
filter = nginx-badbots
action = iptables-multiport[name=BadBots, port="http,https"]

[nginx-noproxy]
enabled = true
port = http,https
logpath = /var/log/nginx/access.log
maxretry = 2
findtime = 600
bantime = 86400  # 24 hours
filter = nginx-noproxy
action = iptables-multiport[name=NoProxy, port="http,https"]

[nginx-limit-req]
enabled = true
port = http,https
logpath = /var/log/nginx/error.log
maxretry = 10
findtime = 60
bantime = 3600  # 1 hour
filter = nginx-limit-req
action = iptables-multiport[name=ReqLimit, port="http,https"]

